import{_ as e}from"./index-Dfmen56X.js";import{r as a,j as t,w as r,o as l,_ as s,$ as o,a0 as n,a4 as u,a8 as i,a3 as d}from"./vendor-DxZSb_3u.js";const c=["srcset","media"],p=["src","data-src","alt"],v={key:0,class:"loading-overlay"},g=e({__name:"OptimizedImage",props:{src:{type:String,required:!0},alt:{type:String,default:""},webpSupport:{type:Boolean,default:!0},imgClass:{type:String,default:""},imgStyle:{type:Object,default:()=>({})},media:{type:String,default:""},threshold:{type:Number,default:.1},blurUp:{type:Boolean,default:!0},placeholderColor:{type:String,default:"#f0f0f0"},showLoader:{type:Boolean,default:!0}},setup(e){const g=e,m=a(null),f=a(!0),w=a(null),y=t((()=>{if(!g.webpSupport||!g.src)return null;if(g.src.toLowerCase().endsWith(".webp"))return g.src;const e=g.src,a=[".jpg",".jpeg",".png"];for(const t of a)if(e.toLowerCase().endsWith(t))return e.substring(0,e.length-t.length)+".webp";return g.src+".webp"})),h=t((()=>g.blurUp?`data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1 1"%3E%3Crect width="1" height="1" fill="${encodeURIComponent(g.placeholderColor)}"%3E%3C/rect%3E%3C/svg%3E`:g.src)),b=()=>{f.value=!1},C=()=>{m.value&&(w.value=new IntersectionObserver((e=>{e[0].isIntersecting&&(m.value.dataset.src&&(m.value.src=m.value.dataset.src,m.value.removeAttribute("data-src")),w.value.disconnect())}),{root:null,threshold:g.threshold,rootMargin:"50px"}),w.value.observe(m.value))};return r((()=>g.src),(()=>{f.value=!0,m.value&&(m.value.dataset.src=g.src,w.value&&(w.value.disconnect(),C()))})),l((()=>{"IntersectionObserver"in window?C():m.value.src=g.src})),(a,t)=>(o(),s("div",{class:d(["optimized-img-container",{loading:f.value,loaded:!f.value}])},[n("picture",null,[y.value?(o(),s("source",{key:0,srcset:y.value,type:"image/webp",media:e.media},null,8,c)):u("",!0),n("img",{ref_key:"imgRef",ref:m,src:h.value,"data-src":e.src,alt:e.alt,class:d([e.imgClass,{"blur-up":e.blurUp}]),style:i(e.imgStyle),loading:"lazy",onLoad:b},null,46,p)]),f.value&&e.showLoader?(o(),s("div",v,t[0]||(t[0]=[n("div",{class:"loading-spinner"},null,-1)]))):u("",!0)],2))}},[["__scopeId","data-v-37e783cf"]]);export{g as O};
